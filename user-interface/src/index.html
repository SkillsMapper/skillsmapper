<!doctype html>
<html lang=en">
<head>
    <title>Skills Mapper</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <!-- [START cloudrun_end_user_firebase_scripts]-->
    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first-->
    <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-app.js"></script>
    <!-- Add Firebase Auth service-->
    <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-auth.js"></script>
    <!-- [END cloudrun_end_user_firebase_scripts]-->
    <script src="/js/config.js"></script>
    <script src="/js/firebase.js"></script>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üñ•Ô∏è</text></svg>">
</head>
<body class="yellow lighten-5">
<nav class="teal darken-3">
    <div class="nav-wrapper container"><a class="brand-logo center" href="#!">Skills Mapper</a>
        <ul class="left" id="nav-mobile">
            <button class="waves-effect waves-light btn" id="signInButton">Sign In with Google</button>
        </ul>
    </div>
</nav>
<div class="section" id="form">
    <div class="row">
        <div class="col s12">
            <div class="row">
                <div class="input-field col s12">
                    <input type="text" id="skill" class="autocomplete">
                    <label for="skill">Skill</label>
                    <ul class="suggestions"></ul>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="input-field col s12">
            <select id="level">
                <option value="interested" selected>Interested in</option>
                <option value="learning">Learning</option>
                <option value="using">Using</option>
                <option value="used">Have used</option>
            </select>
            <label for="level">Level</label>
        </div>
    </div>
    <div class="row">
        <div class="input-field col s12">
            <button class="btn" id="addFact">Add Fact</button>
        </div>
    </div>
</div>
<script>
    document.getElementById('signInButton').addEventListener("click", toggle)

    document.getElementById("addFact").addEventListener("click", function () {
        var skill = document.getElementById("skill").value;
        var level = document.getElementById("level").value;
        addFact(skill, level);
    });

    document.addEventListener('DOMContentLoaded', function () {
        var elems = document.querySelectorAll('select');
        M.FormSelect.init(elems, {});
    });

    document.addEventListener('DOMContentLoaded', function () {
        var elems = document.querySelectorAll('.autocomplete');
        M.Autocomplete.init(elems, {});
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<script>
  document.getElementById("skill").addEventListener("input", function(event) {
    // Get the search input element
    var searchInput = event.target;

    // Get the search prefix
    var prefix = searchInput.value;

    // Set up the HTTP request
    var request = new XMLHttpRequest();
    request.open("GET", "/skills/autocomplete?prefix=" + prefix, true);

    // Set the callback function for when the request finishes
    request.onload = function() {
      if (request.status >= 200 && request.status < 400) {
        // Parse the response as JSON
        var response = JSON.parse(request.responseText);

        // Get the suggestions list element
        var suggestions = document.querySelector(".suggestions");

        // Clear the list
        suggestions.innerHTML = "";

        // Add the suggestions to the list
        response.results.forEach(function(result) {
          var li = document.createElement("li");
          li.textContent = result;
          li.addEventListener("click", function() {
            searchInput.value = result;
            suggestions.innerHTML = "";
          });
          suggestions.appendChild(li);
        });
      }
    };

    // Send the request
    request.send();
  });
</script>
</body>
</html>
